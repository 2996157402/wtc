<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>ç²½å­æ¡‘åŸºå›¾</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: "Microsoft YaHei", sans-serif;
            margin: 20px;
        }
        #saveBtn {
            margin-bottom: 10px;
            padding: 10px 16px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<h2>ç²½å­åˆ¶ä½œæµå‘æ¡‘åŸºå›¾</h2>
<button id="saveBtn">ğŸ“¥ ä¸€é”®ä¿å­˜å›¾åƒ</button>
<div id="sankey"></div>

<script>
    const data = {
        type: "sankey",
        orientation: "h",
        node: {
            pad: 15,
            thickness: 20,
            line: { color: "black", width: 0.5 },
            label: [
                // ç¬¬ä¸€åˆ—ï¼šç²½å­ç§ç±»
                "ç”œç²½", "åœ°æ–¹ç‰¹è‰²ç²½", "å’¸ç²½",

                // ç¬¬äºŒåˆ—ï¼šåœ°åŒº
                "æ–°ç–†", "å±±è¥¿", "æµ·å—", "è´µå·", "æ¹–å—", "å±±ä¸œ", "å¹¿è¥¿", "é™•è¥¿", "æµ™æ±Ÿ", "å¹¿ä¸œ",

                // ç¬¬ä¸‰åˆ—ï¼šé¦…æ–™
                "æ¢…å¹²èœ", "å¹²æœ", "é…¸å¥¶", "æµ·é²œ", "å’¸è›‹é»„", "è‡ç±»", "è±†ç±»", "æœä»", "è‚‰ç±»",

                // ç¬¬å››åˆ—ï¼šç²½å¶ç§ç±»
                "èŠ¦è‹‡å¶", "ç®¬ç«¹å¶", "æŸŠå¶", "èŠ­è•‰å¶", "è·å¶", "æ§²æ ‘å¶"
            ],
            color: []
        },
        link: {
            source: [
                0, 0, 1, 1, 2, 2,   // ç²½å­ç§ç±» -> åœ°åŒº
                3, 4, 5, 6, 7, 8, 9, 10, 11,  // åœ°åŒº -> é¦…æ–™
                12, 13, 14, 15, 16, 17, 18,  // é¦…æ–™ -> ç²½å¶
            ],
            target: [
                3, 4, 5, 6, 7, 8,   // åœ°åŒºç´¢å¼•èµ·å§‹ä¸º3
                12, 13, 14, 15, 16, 17, 18, 18, 12,  // é¦…æ–™ç´¢å¼•èµ·å§‹ä¸º12
                19, 20, 21, 22, 23, 24, 19,  // ç²½å¶ç´¢å¼•èµ·å§‹ä¸º19
            ],
            value: [
                8, 4, 5, 6, 10, 7,
                3, 5, 4, 6, 5, 3, 4, 3, 2,
                6, 5, 3, 2, 4, 3, 2
            ]
        }
    };

    const layout = {
        title: "ç²½å­ç§ç±»-åœ°åŒº-é¦…æ–™-ç²½å¶ æ¡‘åŸºå›¾",
        font: { size: 14 }
    };

    Plotly.newPlot("sankey", [data], layout);

    // ä¸€é”®ä¿å­˜æŒ‰é’®åŠŸèƒ½
    document.getElementById("saveBtn").onclick = function () {
        Plotly.downloadImage("sankey", {format: "png", width: 1000, height: 600, filename: "zongzi_sankey"});
    };
</script>

</body>
</html>
